{% extends 'mc_and_datasheet/base.html' %}

{% block title %}
Section
{% endblock %}
{% block content %}
{% load static %}

<link rel="stylesheet" type="text/css" href="{% static 'mc_and_datasheet/css/sectiona.css' %}">
<link rel="stylesheet" href="{% static 'mc_and_datasheet/css/jquery-ui.css' %}">
<link rel="stylesheet" href="{% static 'mc_and_datasheet/css/bootstrap.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
<link href="{% static 'mc_and_datasheet/css/styles_sidebar.css' %}" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css?family=Merriweather" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>


<title>FEAT-AI</title>


<body>
  <!--Sidebar-->
  <br>
  <br>
  <br>
  <div class="border-end bg-secondary.bg-gradient text-light float-start" id="sidebar-wrapper">
    <div class="sidebar-heading border-bottom bg-dark">Sections</div>
      <div class="list-group list-group-flush bg-white active ">
        {% for section in section_list %}
        <a class="list-group-item-dark list-group-item list-group-item-action p-3 {% if section.id == current_section_id %}active{% endif %}" href="{% url 'mc_and_datasheet:section' section.id %}">
          {{ section.name }}
        </a>
        
        {% endfor %} 
      </div>

        <br>
        <br>
        <button class="list-group-item list-group-item-action list-group-item-dark p-3 bg-secondary" data-toggle="modal" data-target="#myModal" id="popup-btn">
          <i class="fas fa-plus-circle me-2"></i> Add Section
        </button>
        <div id="popup-container"></div>
        <br>
        <a class="list-group-item list-group-item-action list-group-item-dark p-3 bg-success" href="{% url 'mc_and_datasheet:createoutput' section.id  %}" name="createcard" class="submit-button">
          <i class="fas fa-file-export me-2"></i> Export Card to HTML
        </a>
        <br>
        <a class="list-group-item list-group-item-action list-group-item-dark p-3 bg-danger" href="{% url 'mc_and_datasheet:delete' section.id  %}?delete_section=1" name="delete_section" class="delete-button">
          <i class="fas fa-trash-alt me-2"></i> Delete Everything
        </a>
      
    </div>
    </div>
  </div>

  
 <!-- Form Area -->
<h1 class="subtitle"> {{section.name}} </h1>
<form id="section-form" method="post" action="">
    <div class="eticket">
    {% csrf_token %}
       
      {% for field in section.field_set.all %}
        <div>
          {% if field.field_question != 'What is the version date?' %}
           {% if field.field_question != 'Size of the dataset:' %}
            {% if field.field_question != 'Split Ratio:' %}
            
              <li>{{field.field_question}}</li> 

              {% if field.field_question != 'Select the metrics you want to include' %}
              <div class="input-group">
                <textarea id="description" class="form-control bg-dark text-light" type="text" name="a{{field.id}}"></textarea>
                <button type="button" class="btn btn-danger">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z"/>
                    <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z"/>
                  </svg>
                </button>
              </div>
              
              {% endif %}   
            {% endif %}
          {% endif %}
        {% endif %}
        </div> 
      {% endfor %}  

      {% for field in section.field_set.all %}
    
        {% if field.field_question == 'What is the version date?' %}
          
          <li>{{field.field_question}}</li> 
          
          <input type="date" id="appointment-time" name="a{{field.id}}" class="form-control bg-dark text-light">
          
        {% elif field.field_question == 'Size of the dataset:' %} 
          <li>{{field.field_question}}</li> 
          <input type="number" id="trainset" step="1" min="0" max="99999999" value="700" name="a{{field.id}}"><br>
      
        {% elif field.field_question == 'Split Ratio:' %} 
          <li>{{field.field_question}}</li>    
          <input type="number" id="splitratio" step="0.1" min="0.5" max="1.0" value="0.7" name="a{{field.id}}"><br>   
      
        {% elif section.id == 35 %}

        {% endif %}
          
      {% endfor %}
    </div>
    
    {% if section.id == 35 %}  
      
    <div class="container">
      <fieldset>
        <legend>Available metrics</legend>
        <div class="row mb-3">
          
          <div class="col-sm-9">
            <div class="input-group">
              <input type="number" id="accuracy-field" name="accuracy" class="form-control" step="0.01" min="0.1" max="1.0">
              <label for="accuracy" class="input-group-text ms-2">Accuracy</label>
              <div class="input-group-text ms-2">
                <input type="checkbox" id="accuracy" name="accuracy" value="accuracy">
              </div>
            </div>
          </div>
        </div>
        <div class="row mb-3">
          
          <div class="col-sm-9">
            <div class="input-group">
              <input type="number" id="precision-field" name="precision" class="form-control" step="0.01">
              <label for="precision" class="input-group-text ms-2">Precision</label>
              <div class="input-group-text ms-2">
                <input type="checkbox" id="precision" name="precision" value="precision">
              </div>
            </div>
          </div>
        </div>
        <div class="row mb-3">
          
          <div class="col-sm-9">
            <div class="input-group">
              <input type="number" id="mean-error-field" name="mean-error" class="form-control" step="0.01">
              <label for="mean-error" class="input-group-text ms-2">Mean Error</label>
              <div class="input-group-text ms-2">
                <input type="checkbox" id="mean-error" name="mean-error" value="mean-error">
              </div>
            </div>
          </div>
        </div>
      </fieldset>
    </div>
    {% endif %}

    <button type="submit", name="save", value= "save", class="save-button", onclick="saveForm()">Save the Answers</button> 
    <button type="button", class="clear-button" onclick="clearForm()">Clear the answers</button>

    {% if section.id ==  34 or section.id ==  35  %}

    {% else %}
      <input type="text" id="input-text1" name="newfieldtext" placeholder="Add a new question...">
      <button  type="submit" name="newfield" value= "newfield" class="save-button", onclick="saveForm()">Add field</button> 
    {% endif %}

</form>

<form method="post" enctype="multipart/form-data" action="{% url 'mc_and_datasheet:section' section.id %}">
  {% csrf_token %}
  <div class="popup-wrapper" id="popup-wrapper">
    <div class="popup">
      <form id="myForm">
        <label for="input-text">Name of the new section:</label>
        <input type="text" id="input-text2" name="newsectiontext" required>
        <button type="submit" name="sectionsubmit" onclick="location.href=window.location.href + '?cache=' + new Date().getTime()" >Submit</button> 
      </form>
    </div>
  </div>
</form>
{% if section.id == 34 or section.id == 35 %}
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="drop-zone" ondragover="event.preventDefault()" ondrop="event.preventDefault(); document.getElementById('id_file').files = event.dataTransfer.files">
        {% if section.id ==  34 %}
          <p>Drag and drop any image file and the dataset (.csv) file here or click to select files</p>
          {{ form.as_p }}
        {% elif section.id ==  35 %}
          <p>Drag and drop the any image file and the model (.pkl) file here or click to select files</p>
          {{ form.as_p }}
        {% endif %}
    </div>
    <input type="submit", name="upload", value="Upload">
  </form>-->




  <script>
    document.querySelector('.drop-zone').ondragenter = function() {
      this.style.cursor = 'move';
    };
    document.querySelector('.drop-zone').ondragleave = function() {
      this.style.cursor = 'pointer';
    };

    
  </script>
{% endif %}


<script>
  
 
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  src="{% static 'mc_and_datasheet/js/jquery-ui.js' %}"

  

var popupBtn = document.getElementById("popup-btn");
popupBtn.addEventListener("click", function() {
  var popupContainer = document.getElementById("popup-container");
  var popupWindow = document.createElement("div");
  popupWindow.className = "popup-window";
  popupWindow.innerHTML = "<h2>Popup Window</h2><p>Here is some content for the popup window.</p>";
  popupContainer.appendChild(popupWindow);
  var popupBtnRect = popupBtn.getBoundingClientRect();
  popupWindow.style.top = popupBtnRect.top + "px";
  popupWindow.style.left = popupBtnRect.right + "px";
});

  

  function saveForm() {
    const form = document.getElementById('section-form');
    const formData = new FormData(form);
    for (const [key, value] of formData.entries()) {
      localStorage.setItem(key, value);
    }
  }

  function clearForm() {
  localStorage.clear();
  const form = document.getElementById('section-form');
  form.reset();
}
  
  window.onload = function() {
    const form = document.getElementById('section-form');
    for (let i = 0; i < form.elements.length; i++) {
      const element = form.elements[i];
      if (element.type !== 'button') {
        const value = localStorage.getItem(element.name);
        if (value) {
          element.value = value;
        }
      }
    }
  };
   
  
  // Get the current section ID from the URL
  var currentSectionId = '{{ section_id }}';

  // Find the link that matches the current section ID and add the 'active' class to it
  var links = document.querySelectorAll('.navigation-menu a');
  for (var i = 0; i < links.length; i++) {
    var link = links[i];
    if (link.getAttribute('data-section') == currentSectionId) {
      link.classList.add('active');
      break;
    }
  }
  // Add click event listener to delete buttons
  const deleteBtns = document.querySelectorAll('.btn-danger');
deleteBtns.forEach((btn) => {
  btn.addEventListener('click', () => {
    const grandparent = btn.parentNode.parentNode;
    grandparent.parentNode.removeChild(grandparent);
  });
});

// get the date picker input element
const datePicker = document.getElementById('appointment-time');

// get the span element that will display the selected date
const selectedDate = document.getElementById('selected-date');

// add an event listener to the input element that will update the selected date when a new date is selected
datePicker.addEventListener('input', () => {
  selectedDate.textContent = datePicker.value;
});

</script>

<!-- Footer-->
<footer class="footer bg-black small text-center text-white-50"><div class="container px-4 px-lg-5">Copyright &copy; Feat-AI 2023</div></footer>
<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<script src="{% static 'mc_and_datasheet/js/scripts.js' %}"></script>
<script src="{% static 'mc_and_datasheet/js/scripts_sidebar.js' %}"></script>
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
<!-- * *                               SB Forms JS                               * *-->
<!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
<script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>


{% endblock %}