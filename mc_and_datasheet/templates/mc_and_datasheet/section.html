{% extends 'mc_and_datasheet/base.html' %}

{% block title %}
Section
{% endblock %}
{% block content %}
{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'mc_and_datasheet/section.css' %}">

<title>FEAT-AI</title>


<body>
  <div class="navigation-menu">
    {% for section in section_list %}
            <a href="{% url 'mc_and_datasheet:section' section.id %}" {% if section.id == current_section_id %}class="active"{% endif %} >{{ section.name }}</a>
    {% endfor %}


    <div style="text-align: left; position: absolute; bottom: 1; width: 100%; padding-bottom: 30px;">
      <a href="{% url 'mc_and_datasheet:createoutput' section.id  %}" name="createcard" class="submit-button">Export Card to HTML</a>
    </div> 
    
    <div style="text-align: left; position: absolute; bottom: 0; width: 100%; padding-bottom: 30px;">
      <a href="{% url 'mc_and_datasheet:delete' section.id  %}?delete_section=1" name="delete_section" class="delete-button">Delete all data</a>
    </div>
   

  </div>
</body>



<h1 class="subtitle"> {{section.name}} </h1>
<form id="section-form" method="post" action="">
    <div>
    {% csrf_token %}
       
      {% for field in section.field_set.all %}
      
        {{field.field_question}} 
    
        {% if field.field_question == 'What is the version date?' %}
          <input type="date" id="appointment-time" name="a{{field.id}}">
        {% elif field.field_question == 'Size of the dataset:' %} 
        
          <input type="number" id="trainset" step="1" min="0" max="99999999" value="700" name="a{{field.id}}">
        
        {% elif field.field_question == 'Split Ratio:' %} 
        
          <input type="number" id="splitratio" step="0.1" min="0.5" max="1.0" value="0.7" name="a{{field.id}}">   
        
        {% elif section.id == 35 %}
        
        {% else %} 
          <input type="text", name="a{{field.id}}">
        {% endif %}
      {% endfor %}
    </div>
    
    {% if section.id == 35 %}  
      
    <fieldset>
      <legend>Available metrics</legend>
      <div class="form-group">
        <label for="accuracy-field">Accuracy:</label>
        <input type="number" id="accuracy-field" name="accuracy" step="0.01" min="0.1" max="1.0">
        <label for="accuracy"></label>
        <input type="checkbox" id="accuracy" name="accuracy" value="accuracy"
               checked>
        
      </div>
      <div class="form-group">
        <label for="precision-field">Precision:</label>
        <input type="number" id="precision-field" name="precision" step="0.01">
        <label for="Precision"></label>
        <input type="checkbox" id="precision" name="precision" value="precision">  
        
      </div>
      <div class="form-group">
        <label for="mean-error-field">Mean Error:</label>
        <input type="number" id="mean-error-field" name="mean-error" step="0.01">
        <label for="mean-error"></label>
        <input type="checkbox" id="mean-error" name="mean-error"value="mean-error">
      </div>
    </fieldset>
    {% endif %}

    <button type="submit", name="save", value= "save", class="save-button", onclick="saveForm()">Save the Answers</button> 
    <button type="button", class="clear-button" onclick="clearForm()">Clear the answers</button>

    {% if section.id ==  34 or section.id ==  35  %}

    {% else %}
      <input type="text", name="newfieldtext", placeholder="Add a new question...">
      <button  type="submit", name="newfield", value= "newfield" class="save-button", onclick="saveForm()">Add field</button> 
    {% endif %}

</form>


{% if section.id == 34 or section.id == 35 %}
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="drop-zone" ondragover="event.preventDefault()" ondrop="event.preventDefault(); document.getElementById('id_file').files = event.dataTransfer.files">
        {% if section.id ==  34 %}
          <p>Drag and drop any image file and the dataset (.csv) file here or click to select files</p>
          {{ form.as_p }}
        {% elif section.id ==  35 %}
          <p>Drag and drop the any image file and the model (.pkl) file here or click to select files</p>
          {{ form.as_p }}
        {% endif %}
    </div>
    <input type="submit", name="upload", value="Upload">
  </form>




  <script>
    document.querySelector('.drop-zone').ondragenter = function() {
      this.style.cursor = 'move';
    };
    document.querySelector('.drop-zone').ondragleave = function() {
      this.style.cursor = 'pointer';
    };

    
  </script>
{% endif %}

<script>
  
 
  
  function saveForm() {
    const form = document.getElementById('section-form');
    const formData = new FormData(form);
    for (const [key, value] of formData.entries()) {
      localStorage.setItem(key, value);
    }
  }

  function clearForm() {
  localStorage.clear();
  const form = document.getElementById('section-form');
  form.reset();
}
  
  window.onload = function() {
    const form = document.getElementById('section-form');
    for (let i = 0; i < form.elements.length; i++) {
      const element = form.elements[i];
      if (element.type !== 'button') {
        const value = localStorage.getItem(element.name);
        if (value) {
          element.value = value;
        }
      }
    }
  };
   
  
  // Get the current section ID from the URL
  var currentSectionId = '{{ section_id }}';

  // Find the link that matches the current section ID and add the 'active' class to it
  var links = document.querySelectorAll('.navigation-menu a');
  for (var i = 0; i < links.length; i++) {
    var link = links[i];
    if (link.getAttribute('data-section') == currentSectionId) {
      link.classList.add('active');
      break;
    }
  }
  
</script>



  

{% endblock %}