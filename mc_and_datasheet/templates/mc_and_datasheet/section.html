
{% extends 'mc_and_datasheet/base.html' %}
{% block title %}
Section
{% endblock %}
{% block content %}
{% load static %}
<link rel="stylesheet" href="{% static 'mc_and_datasheet/css/jquery-ui.css' %}">
<link rel="stylesheet" href="{% static 'mc_and_datasheet/css/bootstrap.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.4/font/bootstrap-icons.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="{% static 'mc_and_datasheet/css/styles_sidebar.css' %}" />
<link rel="stylesheet" type="text/css" href="{% static 'mc_and_datasheet/css/sectiona.css' %}">
<link href="https://fonts.googleapis.com/css?family=Merriweather" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">


<style>
   body {
   font-family: 'Open Sans', sans-serif;
   background-image: url({% static 'mc_and_datasheet/assets/img/section.jpg' %});
   background-repeat: no-repeat;
   background-size: cover;
   }
   @media(max-width:400px){
   .checkboxlabel{
   display:block;  
   }
   }
   .list-group-item {
   background-color: #343a40;
   color: #ffffff;
   }
   .list-group-item:hover {
   background-color: #0980e1;
   color: #fff;
   }
  
</style>
<title>FEAT-AI</title>
<body>
   <div class="active" id="sidebar-wrapper">
      <div class="list-group sidebar-heading border-bottom bg-secondary">Sections</div>
      <div class="list-group list-group-flush bg-white active ">
         {% for section in section_list %}
         <a class="list-group-item-dark list-group-item list-group-item-action p-2 {% if section.id == current_section_id %}active{% endif %}" href="{% url 'mc_and_datasheet:section' section.id %}">
         {{ section.name }}
         </a>
         {% endfor %} 
      </div>
      <br>
      <br>
      <button class="list-group-item list-group-item-action list-group-item-dark p-2 bg-secondary" data-bs-toggle="modal" data-bs-target="#myModal" id="popup-btn">
      <i class="fas fa-plus-circle me-2"></i> Add Section
      </button>
      <br>
      <a id="exportButton" class="list-group-item list-group-item-action list-group-item-dark p-2 bg-success"
      data-bs-toggle="modal" data-bs-target="#exportModal">
      <i class="fas fa-file-export me-2"></i> Export Model Card
      </a>
      <br>
      <a class="list-group-item list-group-item-action list-group-item-dark p-2 bg-danger" href="{% url 'mc_and_datasheet:delete' section.id  %}?delete_section=1" name="delete_section" class="delete-button">
      <i class="fas fa-trash-alt me-2"></i> Default
      </a>
      <br>
      <a class="list-group-item list-group-item-action list-group-item-dark p-2 bg-warning" data-bs-toggle="modal" data-bs-target="#uploadModal">
         <i class="fas fa-upload me-2"></i> Upload Json
     </a>
   </div>
   </div>
   </div>
   <!-- Form Area -->
   <!-- Modals -->
   <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
         <div class="modal-content" style="background-color:#333333">
            <div class="modal-header">
               <h5 class="modal-title" id="myModalLabel" style="color:white">Add Section</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form method="POST">
               {% csrf_token %}
               <div class="modal-body">
                  <div class="form-group">
                     <label for="section-name" style="color:white">Enter the name of the new section:</label>
                     <input type="text" class="form-control" id="section-name" name="newsectiontext">
                  </div>
               </div>
               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                  <button type="submit" class="btn btn-secondary" name="sectionsubmit" onclick="location.href=window.location.href + '?cache=' + new Date().getTime()" >Submit</button> 
               </div>
            </form>
         </div>
      </div>
   </div>
   
   <!-- The modal structure for export -->
   <div class="modal fade" id="exportModal" tabindex="-1" role="dialog" aria-labelledby="exportModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
         <div class="modal-content" style="background-color:#333333">
            <div class="modal-header">
               <h5 class="modal-title" id="exportModalLabel" style="color:white" >Export Model Card</h5>
               <button type="button" class="btn-close text-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
               <label for="section-name" style="color:white">Select the desired output format:</label>
               <br>
               <br>
               <div class="row">
                  <div class="col-4">
                     <button id="htmlButton" type="button" class="btn btn-secondary mb-3">
                        <i class="fas fa-file-export me-1"></i> HTML
                     </button>
                  </div>
                  <div class="col-4">
                     <button id="protoButton" type="button" class="btn btn-secondary mb-3">
                        <i class="fas fa-file-code me-1"></i> Proto
                     </button>
                  </div>
                  <div class="col-4">
                     <button id="jsonButton" type="button" class="btn btn-secondary mb-3">
                        <i class="fas fa-file-code me-1"></i> JSON
                     </button>
                  </div>
               </div>
            </div>
            <div class="modal-footer">
               <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
         </div>
      </div>
   </div>
   <!-- The modal structure for uploading -->
   <div class="modal fade" id="uploadModal" tabindex="-1" role="dialog" aria-labelledby="uploadModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
         <div class="modal-content" style="background-color:#333333">
            <div class="modal-header">
               <h5 class="modal-title" id="uploadModalLabel" style="color:white" >Upload Json File</h5>
               <button type="button" class="btn-close text-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
               <form method="post" enctype="multipart/form-data" action="{% url 'mc_and_datasheet:upload_json' section.id %}">
                  {% csrf_token %}
                  <div class="mb-3">
                     <label for="json_file" class="form-label" style="color:white">Select Json File:</label>
                     <input type="file" class="form-control" id="json_file" name="json_file" accept=".json" required>
                  </div>
                  <button type="submit" class="btn btn-primary">
                     <i class="fas fa-upload mr-1"></i> Upload and Process
                  </button>
               </form>
            </div>
            <div class="modal-footer">
               <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
         </div>
      </div>
   </div>




   <br>
   <br>
   <br>

   <div id="main-content">

   <!-- Form Area For Questions -->
   <div class="container survey" style= " z-index: 1; " >
   <form method = 'POST' id="survey-form" class=".bg-secondary.bg-gradient text-white px-10 py-10" style="margin-left: 125px; z-index: 1; ">
      {% csrf_token %}
      <div class="form-row" style= " z-index: 1; "  >
         <h1 id="title" class="text-white-50 mx-auto mt-2 mb-5 text-center" style="z-index: 1; ">{{section.name}} </h1>
         <p id="description" class="text-white-50 mx-auto mt-2 mb-2 text-center" style="z-index: 1; text-align: justify; margin-left: 20px; margin-right: 20px;">{{ section.section_desc }}</p>
         {% for value in field_values %}
         {% for field in field_set %}
         {% if forloop.counter0 == forloop.parentloop.counter0 %}
            <div class="col" style= " z-index: 1; " >
            {% if field.field_question != 'Select the metrics you want to include:' %}
            {% if field.field_question != 'What is the version date?' %}
            {% if field.field_question != 'Size of the dataset:' %}
            {% if field.field_question != 'Split Ratio:' %}
            <br>
            <div class="input-group">
               {{ field.field_question }}
               <div class="input-group-append">
                  {% if field.field_helper %}
                  <div class="tooltip-container" style="margin-left: 10px;">
                     <img src="{% static 'mc_and_datasheet/assets/question-circle-fill.svg' %}" alt="Question Icon" data-toggle="tooltip" data-placement="top" title="{{ field.field_helper|escape }}" style="background-color: transparent;">
                     <style>
                        .tooltip-inner {
                        max-width: 500px; /* Adjust the width as needed */
                        }
                     </style>
                  </div>
                  {% endif %}
               </div>
            </div>
            {# different for quantitative anaylsis #}
            <div class="input-group" style="z-index: 1;">
               <textarea id="description_answer_{{forloop.counter0}}" class="form-control bg-dark text-light description-answer" type="text" name="a{{ field.id }}" style="z-index: 1;">{{ value }}</textarea>
               <button type="button" class="btn btn-danger">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                     <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z"/>
                     <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z"/>
                  </svg>
               </button>
            </div>
         </div>
         {% endif %}  
         {% endif %}  
         {% endif %}
         {% endif %}
         {% endif %}
         {% endfor %}
         {% endfor %}
      </div>
      {% for field in section.field_set.all %}
      {% if field.field_question == 'What is the version date?' %}
      <br>
      <div class="tooltip-container" style="margin-left: 10px;">
         <label id="name-label">{{field.field_question}}</label>
         <img src="{% static 'mc_and_datasheet/assets/question-circle-fill.svg' %}" alt="Question Icon" data-toggle="tooltip" data-placement="top" title="{{ field.field_helper|escape }}" style="background-color: transparent;">
         <style>
            .tooltip-inner {
            max-width: 500px; /* Adjust the width as needed */
            }
         </style>
      </div>
      <input type="date" id="appointment-time" name="a{{field.id}}" class="form-control bg-dark text-light">
      {% elif field.field_question == 'Size of the dataset:' %} 
      <br>
      <label id="name-label">{{field.field_question}}</label>
      <input type="number" id="trainset" step="1" min="0" max="99999999" value="700" name="a{{field.id}}"><br>
      {% elif field.field_question == 'Split Ratio:' %} 
      <br>
      <label id="name-label">{{field.field_question}}</label>   
      <input type="number" id="splitratio" step="0.1" min="0.5" max="1.0" value="0.7" name="a{{field.id}}"><br>   
      <br>
      <small style="font-size: 80%;">This section will be expanded </small>
      {% elif section.id == 35 %}
      {% endif %}
      {% if section.id == 35 %}  
      {% if field.field_question == 'Select the metrics you want to include:' %}
      <br>
      <br>
      {{ field.field_question }}
      <div class="container_metrics">
         <fieldset>
            <br>
            <!-- <legend>Available metrics: </legend> -->
            <div class="row mb-3">
               <div class="col-sm-4">
                  <div class="input-group">
                     <label for="accuracy-field">Accuracy:</label>
                     <input type="number" id="accuracy-field" name="accuracy" class="form-control bg-dark text-light" step="0.01" min="0.1" max="1.0" style="width: 100px; margin-left: 18px;">
                     <div class="input-group-text ms-2 bg-dark">
                        <input type="checkbox" id="accuracy" name="accuracy" value="accuracy">
                     </div>
                  </div>
               </div>
               <div class="col-sm-4">
                  <div class="input-group">
                     <label for="precision-field">Precision:</label>
                     <input type="number" id="precision-field" name="precision" class="form-control bg-dark text-light" step="0.01" style="width: 100px; margin-left: 20px;">
                     <div class="input-group-text ms-2 bg-dark">
                        <input type="checkbox" id="precision" name="precision" value="precision">
                     </div>
                  </div>
               </div>
               <div class="col-sm-4">
                  <div class="input-group">
                     <label for="mean-error-field">Brier Score:</label>
                     <input type="number" id="mean-error-field" name="mean-error" class="form-control bg-dark text-light" step="0.01" min="0.1" max="1.0" style="width: 95px; margin-left: 10px;">
                     <div class="input-group-text ms-2 bg-dark">
                        <input type="checkbox" id="mean-error" name="mean-error" value="mean-error">
                     </div>
                  </div>
               </div>
            </div>
            <div class="row mb-3">
               <div class="col-sm-4">
                  <div class="input-group">
                     <label for="recall-field">Recall:</label>
                     <input type="number" id="recall-field" name="recall" class="form-control bg-dark text-light" step="0.01" min="0.1" max="1.0" style="width: 100px; margin-left: 32px;">
                     <div class="input-group-text ms-2 bg-dark">
                        <input type="checkbox" id="recall" name="recall" value="recall">
                     </div>
                  </div>
               </div>
               <div class="col-sm-4">
                  <div class="input-group">
                     <label for="f1-score-field">F1 Score:</label>
                     <input type="number" id="f1-score-field" name="f1-score" class="form-control bg-dark text-light" step="0.01" style="width: 100px; margin-left: 20px;">
                     <div class="input-group-text ms-2 bg-dark">
                        <input type="checkbox" id="f1-score" name="f1-score" value="f1-score">
                     </div>
                  </div>
               </div>
               <div class="col-sm-4">
                  <div class="input-group">
                     <label for="specificity-field">AUC Score :</label>
                     <input type="number" id="specificity-field" name="specificity" class="form-control bg-dark text-light" step="0.01" min="0.1" max="1.0" style="width: 95px; margin-left: 10px;">
                     <div class="input-group-text ms-2 bg-dark">
                        <input type="checkbox" id="specificity" name="specificity" value="specificity">
                     </div>
                  </div>
               </div>
            </div>
         </fieldset>
         <small style="font-size: 80%;">This section will be expanded </small>
      </div>
      {% endif %}
      {% endif %}
      {% endfor %} 
      <!-- </form> -->
      <hr style="border-width: 3px;">
      {% if section.id ==  34 or section.id ==  35  %}
      {% else %}
   <form method="POST" >
      {% csrf_token %}
      <div class="form-group">
         <label id="email-label">Customize</label>
         <div class="input-group">
            <input id="input-text1" name="newfieldtext" type="text" class="form-control bg-secondary text-dar" aria-describedby="emailHelp" placeholder="Type the text of your new question.">
            <button type="submit" name="newfield" value= "newfield" class="btn btn-primary" onclick="saveForm()">
               <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="fas fa-plus" viewBox="0 0 16 16">
                  <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z"/>
                  <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z"/>
               </svg>
            </button>
         </div>
         <small id="emailHelp" class="form-text text-muted-lg" style="color: rgb(110, 110, 110);">You can add a new question if you have a specific desire for the model card.</small>
      </div>
      {% endif %}
      <div>
         <button type="submit" name="save" value= "save" class="btn btn-outline-secondary" style="float:right" onclick="saveForm()">Save the Answers</button>
         <button type="button" name="clear" value = "clear" class="btn btn-outline-secondary"  style="float:right" id="clearBtn">Clear the answers</button>
      </div>
      <br>
      <br>
      <br>
   </form>
   <div style="text-align: left;">
      {% if section.id == 34 or section.id == 35 %}
      {% if section.id == 34 %}
      <div class="drop-zone" ondragover="event.preventDefault()" ondrop="event.preventDefault(); document.getElementById('id_file').files = event.dataTransfer.files">
         <form method="post" enctype="multipart/form-data" action="{% url 'mc_and_datasheet:upload_file' section.id %}">
            <p>Drag and drop any image file here or click to select files</p>
            {% csrf_token %}
            {{ form.as_p }}
            <button class="list-group-item list-group-item-action list-group-item-dark p-3 bg-secondary" type="submit" name="upload34" value="upload">
            <i class="fas fa-cloud-upload-alt fa-lg fa-fw me-2"></i> Upload
            </button>
         </form>
      </div>
      {% elif section.id == 35 %}
      <div class="drop-zone" ondragover="event.preventDefault()" ondrop="event.preventDefault(); document.getElementById('id_file').files = event.dataTransfer.files">
         <p>Drag and drop the any image file here or click to select files</p>
         <form method="post" enctype="multipart/form-data" action="{% url 'mc_and_datasheet:upload_file' section.id %}">
            {% csrf_token %}
            {{ form.as_p }}
            <button class="list-group-item list-group-item-action list-group-item-dark p-3 bg-secondary" type="submit" name="upload35" value="upload">
            <i class="fas fa-cloud-upload-alt fa-lg fa-fw me-2"></i> Upload
            </button>
         </form>
      </div>
      {% endif %}
      {% endif %}
      <br>
      {% if is_files %}
      <form>
         {% csrf_token %}
         <!-- Add a button to toggle the visibility of uploaded files -->
         <button type="button" id="toggleFilesButton" class="btn btn-primary btn-sm ">Hide/show files</button>
         <ul id="fileList" style="display: none;">
            {% for file in files %}
            {% if file.uploaded_section_id == section.id %}
            <li>                
               <a>{{ file.name }}</a>
               <small style="font-size: 80%;">uploaded {{ file.uploaded_at }}</small>
            </li>
            {% endif %}
            {% endfor %}
         </ul>
      </form>
      {% endif %}
   </div>
   </div>
</div>
</div>
   

   {% if section.id == 31 %}
   <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
   {% elif section.id == 32 %}
   <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
   {% elif section.id == 33 %}
   <br><br><br><br><br><br><br><br><br><br><br>
   {% elif section.id == 34 %}
   <br><br><br><br><br><br><br><br><br><br><br><br><br><br>
   {% elif section.id == 35 %}
   <br><br><br><br><br><br><br><br><br>
   {% elif section.id == 36 %}
   <br><br><br><br><br><br><br><br><br><br><br><br>
   {% endif %}
 


   <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
   <!-- Core theme JS-->
   <script src="{% static 'mc_and_datasheet/js/sectiona.js' %}"></script>
   <script src="{% static 'mc_and_datasheet/js/scripts.js' %}"></script>
   <script src="{% static 'mc_and_datasheet/js/scripts_sidebar.js' %}"></script>
   <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
   <!-- * *                               SB Forms JS                               * *-->
   <!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
   <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
   <!-- <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script> -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

   {% endblock %}
   </body>   
   <!-- Footer-->
   <!--<footer class="footer bg-black small text-center text-white-50"><div class="container px-4 px-lg-5">Copyright &copy; Feat-AI 2023</div></footer>-->
   <!-- Bootstrap core JS-->

   